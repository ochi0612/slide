<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>スライド</title>
</head>

<body>
    <!-- C:/Users/0025230/Desktop/anything/slide/test.html -->
    <div class="slide_wrapper">
        <div class="imgs">
            <div class="imgs_wrapper">
                <img src="https://careers.gizumo-inc.jp/wp-content/uploads/sites/2/2019/02/af69a27abc85ea45435f04cc7c000cdd.jpg">
                <img src="https://careers.gizumo-inc.jp/wp-content/uploads/sites/2/2019/02/66c46d52639c6ace1905a30968467496.jpg">
                <img src="https://careers.gizumo-inc.jp/wp-content/uploads/sites/2/2019/02/55d1f98511442a29819c76f89eeadb05.jpg">
                <img src="https://careers.gizumo-inc.jp/wp-content/uploads/sites/2/2019/02/29bab4e99a865c1fb42e7e16e26eca2d.jpg">
            </div>
        </div>
        <div class="btns">
            <button class="btns_left" data-item="left">左</button>
            <button class="btns_right" data-item="right">右</button>
        </div>
    </div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>

//レスポンシブ
$(window).on("load resize", function() {
    var w_width = $(this).width();
    var img = w_width * 0.4;
    var imgs_width = img * 1.5;
    var slide_width = imgs_width * 1.4;
    var btn_height = img + 20;
    var btn_width = (slide_width - imgs_width - 20) / 2;
    var imgs_wrapper_width = img * 6;
    var imgs_wrapper_margin = img * 2 - ((imgs_width - img) / 2);

    $(".slide_wrapper").css({
        "width":slide_width + "px",
    });

    $(".btns > button").css({
        "width":btn_width + "px",
        "height":btn_height + "px"
    });

    $(".imgs_wrapper > img").css({
        "width":img + "px",
        "height":img + "px"
    });

    $(".imgs").css({
        "width":imgs_width + "px",
        "height":img + "px"
    });

    $(".imgs_wrapper").css({
        "margin-left":"-" + imgs_wrapper_margin + "px",
        "width":imgs_wrapper_width + "px"
    });
});

$(function(){

    var first_img = ".imgs_wrapper img:first";
    var last_img = ".imgs_wrapper img:last";
    var slide_timer;
    var bool = true;
    var w_width = $(this).width();
    var img_count = $(".imgs_wrapper").children("img").length;

    addCloneImg(img_count);
    startSlide();



    $(".btns > button").on('click', function() {
        data_item = $(this).data("item");
        stopTimer();
        slide(data_item);
    });

    //自動でスライド切り替え
    function startSlide(time = 2000) {
        slide_timer = setTimeout(function() {
            startSlide();
            slide("auto");
        } , time);
    }

    //タイマーストップ時の処理
    function stopTimer() {
        clearTimeout(slide_timer);
        startSlide(5000);
    }

    //画像の複製
    function addCloneImg(img_count) {
        if(img_count <= 0) {//画像がない場合
            $(".imgs_wrapper").before("<p>画像がありません</p>");
        } else if (img_count <= 6 ) {//画像が6枚以下の時
            img_count *= 2;
            $(".imgs_wrapper").find("img").clone().appendTo(".imgs_wrapper");
            addCloneImg(img_count);
        } else if (img_count >= 6) {//画像が6枚以上の時
            for (var i = 0; i < 2; i++) {
                $(last_img).insertBefore(first_img);
            }
        }
    }

    //スライドの挙動
    function slide(data_item) {
        if (bool === true) {
            bool = false;
            if (data_item === "left") {
                $.when(
                    $(last_img).insertBefore(first_img).css('display','none'),
                    $(first_img).animate({ width:'show'}, { duration: 'slow', easing: 'swing', })
                ).done(function() {
                    bool = true;
                });
            } else if(data_item === "auto" || data_item === "right" ) {
                $.when(
                    $(first_img).animate({ width: 'hide' }, { duration: 'slow', easing: 'swing', })
                ).done(function() {
                    $(first_img).insertAfter(last_img).css('display', 'inline-block');
                    bool = true;
                });
            }
        }
    }
});

</script>
<style>

.slide_wrapper {
    margin: 2em auto 0;
    position: relative;
}

.imgs {
	overflow: hidden;
    margin: 0 auto;
	border: 10px solid #ffffff;
	box-shadow:0px 0px 5px 0px rgba(0,0,0,0.5);
}

.imgs_wrapper {
    font-size: 0;
}

.btns_left {
    position: absolute;
    top: 0px;
    left: 0px;
}

.btns_right {
    position: absolute;
    top: 0px;
    right: 0px;
}
</style>
</html>
